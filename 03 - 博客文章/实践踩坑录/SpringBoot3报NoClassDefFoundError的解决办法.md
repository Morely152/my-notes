---

---
--- 
> 声明：存在由AI生成的小部分内容，仅供参考，请仔细甄别可能存在的错误。
--- 
# 一、前提情景

在SpringBoot的项目中，添加了`huttool`工具类中的`hutool-all`、以及`hutool-poi`，以实现一个数据库信息Excel导入/导出功能。代码可以通过编译，但是在前端调用接口时报告了`java.lan.NoClassDefFoundError`的错误（报错信息详见下图）。

![](20251101113332330.png)

查询相关文章，大多认为是依赖版本不对/依赖重复的问题，遂尝试了多种版本，均没有解决问题。后通过豆包的方案顺利解决，这里记录一下解决流程，欢迎大家一起交流讨论。

# 二、解决步骤

## 1.问题剖析

豆包指出，**Maven可能存在缓存过期或依赖未正确下载的情况，导致包含`ExcelUtil`类的`hutool-poi`模块未能正确加载**。因此为了解决这个问题，需要手动清理本地的依赖缓存，并重新下载依赖。

## 2.删除相关依赖

先停止正在运行的SpringBoot项目，根据报错目标的包位置，找到对应的依赖缓存目录，默认为以下格式：

```text
C:\Users\用户名\.m2\repository\cn\hutool
```

![](20251101114654750.png)

删除对应的文件夹。

## 3.重新下载依赖

点击下图中的按钮，打开Maven的控制台：

![](20251101114904794.png)

然后输入以下命令，强制清理本地仓库中的项目依赖包并且重新下载，以确保依赖完整：

``` bash
mvn clean dependency:purge-local-reposity
```

执行命令，等待控制台中的任务执行完毕，maven重建索引结束。

## 4.重启项目

依赖重建后，重启IDEA，运行SpringBoot项目，此时调用接口，可以看到Excel顺利导出了，问题得以解决。

--- 
# 三、后记

此问题于数日前，在我学习B站UP“程序员青戈”老师的【带小白做毕设】系列课程时首次出现，并且在今天使用另一个工具类时再次出现；两次均以此方案解决，证明此解决办法适用于此类型的报错。

此文章仅代表个人的经验之谈；如有不妥之处，欢迎大家在评论区指正！