---

---
--- 
> 声明：本篇笔记遵循[CC BY 4.0协议](https://creativecommons.org/licenses/by/4.0/legalcode.zh-hans)。存在由AI生成的小部分内容，仅供参考，请仔细甄别可能存在的错误。

假设我们在开发一款专注软件，核心功能是由用户端设置专注的时长，然后由服务端进行在线监督并且实时返回剩余的时间，实现一个联网的计时器服务。

常见软件项目开发需要经过这样几个主要流程：

1. **需求分析**：分析软件具体的功能（跟甲方各种聊天…）；
2. **技术选型**：选择合适的开发技术（开发框架、数据库等）；
3. **总体设计**：设计软件的基本架构、数据结构、各个模块、网络接口等详细内容；
4. **程序编写**：编写软件的代码程序（普通意义上的“程序员”的工作…）；
5. **软件测试**：测试软件的功能以及性能是否达到预期标准，是否存在影响正常使用的恶性bug；
6. **发布上架**：完成审核备案等流程，上线到应用商店、小程序等公众平台，正式对用户开放使用；
7. **运维迭代**：软件上线后的运营和维护，以及现有问题的优化解决、新版本的升级迭代。

我们计划在`Intellij IDEA`中，基于之前学习的多线程、TCP编程以及UDP编程等Java技术，根据上面的步骤来从0实现这个联网计时器。
# 一、起步：需求分析＆技术选型

## 1.分析项目具体需求 

> 在做任何项目之前，我们需要清楚这个项目需要实现什么功能，接受怎样的输入和提供怎样的输出。这样的需求往往在工作中由甲方在与产品经理的交流中总结出来；但是当我们自己开发项目时，或者我们有成为产品经理的志向时，拥有专业准确的需求分析与概括能力是至关重要的。

简单概括一下我们的需求：

- 核心功能：
	- 客户端发起计时请求
	- 服务端接受请求，并且持续告诉客户端剩余的时间
- UI界面
	- 这里为了简化项目，计划采用终端来呈现数据的输入/输出

## 2.选择开发技术

- 我们选择**Java SE**来开发这个项目，采用`Java 21`版本的JDK进行程序编写工作；
- 注意到客户端发起的计时请求包含时长数据，这个数据类似于微信消息，不允许丢失或者出错，因此考虑使用更可靠的**TCP协议**；
- 服务端告知剩余时间的行为类似于视频通话，需要很快的传输速度，同时可以接受一小部分的丢失（表现为低延迟，网络状况不良时略有卡顿），适合使用更快捷的**UDP协议**；
- 暂无数据持久化保存的需求，不考虑使用文件或数据库来保存数据。
- 服务端要求具有并行处理能力，计划使用**线程池**来实现。
- 需要并行处理大量计时任务，计划采取**时间轮算法**[^1]。

> 注：这里只是为了兼顾TCP和UDP，在初学者的角度展现两种通信协议的特点，采取了两种协议都使用的策略；实际开发中有综合使用的场景，也经常只用TCP或只用UDP；另外也不要产生“客户端用TCP，服务端用UDP”的错觉；实际上由哪一方使用哪种协议是很灵活的；需要根据各种协议的优势来综合考虑。

## 3.程序详细设计

### ① 功能设计

- 客户端：
	- 前端输入：首先由用户输入“MM:SS”格式的时间，并且通过正则表达式进行合法性校验；
	- 后端请求：将时长发送到服务端，使用TCP协议发起计时请求。
- 服务端：
	- 请求处理：接收客户端的计时请求，每过1s返回剩余的时间，计时结束后进行提醒。

### ② 性能参数（主要是服务端的性能）

- 误差与延迟：服务端计时误差应该不超过$\pm 1s/60s$，响应延迟在100ms以内；
- 抗压能力：要求拥有一定的并行处理能力，同时处理不少于10个客户端的计时任务；

## 4.软件编写

1. 首先在IDEA中新建项目`NetworkTimer`：

![](20251002014023166.png#bc)

2. 我们的项目构建工具Maven已在（十四）节中介绍过，如果没有印象可以先回头复习一下；现在我们在`src/main/java`中新建两个Java类，分别命名为`Client`和`Server`，即客户端程序与服务端程序的源代码文件：

![](20251002014838050.png#bc)

3. 根据我们之前学习的内容，写出以下的程序：

① 客户端 `Client.java`

```java

```

② 服务端 `Server.java`

```java

```

## 5.软件测试


--- 
# 参考资料

[^1]: 程序员Derozan.一文直接搞懂时间轮算法的精妙之处\[EB/OL].(2023-02-25)\[2025-10-01]. https://zhuanlan.zhihu.com/p/609284043